land_full = recode(substr(geo, 1, 2),
"BE" = "Belgia",
"BG" = "Bulgaria",
"NL" = "Nederland",
"NO" = "Norge")) %>%
ggplot(aes(x = land_full, y = GDPC, fill = land_full)) +
geom_boxplot() +
labs(
title = "BNP per innbygger etter land",
x = "Land",
y = "BNP per innbygger (euro)"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")
bnp_per_innbygger_land
# Utvikling av BNP per innbygger over tid (medianverdi)
bnp_over_tid_median <- gdp_pop %>%
mutate(land = substr(geo, 1, 2)) %>%
group_by(land, TIME_PERIOD) %>%
summarise(
median_BNPI = median(GDPC, na.rm = TRUE),
.groups = "drop"
) %>%
mutate(land_full = recode(land,
"BE" = "Belgia",
"BG" = "Bulgaria",
"NL" = "Nederland",
"NO" = "Norge")) %>%
ggplot(aes(x = TIME_PERIOD, y = median_BNPI, color = land_full)) +
geom_line(linewidth = 1.2) +
scale_y_continuous(limits = c(0, 70000),
labels = scales::comma) +
labs(
title = "Utvikling i median BNP per innbygger (2000–2023)",
x = "År",
y = "BNP per innbygger (euro)",
color = "Land"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
legend.title = element_text(face = "bold"),
legend.position = "right"
)
bnp_over_tid_median
# Beregner befolkningsvektet Gini på NUTS2-nivå (basert på GDPC for NUTS3)
gini <- gdp_pop %>%
mutate(
NUTS2   = substr(geo, 1, 4),# Henter NUTS2-kode fra NUTS3 og legger til landkode
country = substr(geo, 1, 2)
) %>%
filter(values_pop > 0, is.finite(GDPC)) %>% # Fjerner ugyldige observasjoner (befolkning ≤ 0 eller manglende
group_by(country, NUTS2, TIME_PERIOD) %>%
summarise(
n_nuts3 = dplyr::n(),# Teller hvor mange NUTS3-regioner som inngår i hver NUTS2-gruppe
Gini_weighted = if (dplyr::n() >= 2) {
# Beregner befolkningsvektet Gini ved hjelp av funksjonen gini.wtd()
as.numeric(dineq::gini.wtd(GDPC, weights = values_pop))
} else {
NA_real_
}, # Hvis NUTS2 bare består av én NUTS3 → ingen intern ulikhet → Gini settes til NA
.groups = "drop"
)
# Sjekker struktur og summary
# Sjekker strukturen til Gini-resultatene
glimpse(gini)
# Oppsummerer Gini-fordelingen
summary(gini$Gini_weighted)
# statistikk totalt gini
gini_totalt <- gini %>%
summarise(
n_obs = sum(!is.na(Gini_weighted)),
Min   = min(Gini_weighted, na.rm = TRUE),
Q1    = quantile(Gini_weighted, 0.25, na.rm = TRUE),
Median= median(Gini_weighted, na.rm = TRUE),
Mean  = mean(Gini_weighted, na.rm = TRUE),
Q3    = quantile(Gini_weighted, 0.75, na.rm = TRUE),
Max   = max(Gini_weighted, na.rm = TRUE),
SD    = sd(Gini_weighted, na.rm = TRUE)
)
gini_totalt
# statistikk gini etter land
gini_etter_land <- gini %>%
group_by(country) %>%
summarise(
n_obs = sum(!is.na(Gini_weighted)),
Min   = min(Gini_weighted, na.rm = TRUE),
Q1    = quantile(Gini_weighted, 0.25, na.rm = TRUE),
Median= median(Gini_weighted, na.rm = TRUE),
Mean  = mean(Gini_weighted, na.rm = TRUE),
Q3    = quantile(Gini_weighted, 0.75, na.rm = TRUE),
Max   = max(Gini_weighted, na.rm = TRUE),
SD    = sd(Gini_weighted, na.rm = TRUE),
.groups = "drop"
)
gini_etter_land
# {r, fig.cap="Gini per NUTS2 over tid, fasettert per land", fig.alt="Tynne linjer for hver NUTS2 med fasetter per land"}
gini %>%
filter(!is.na(Gini_weighted)) %>%
ggplot(aes(TIME_PERIOD, Gini_weighted, group = NUTS2)) +
geom_line(alpha = 0.25) +
facet_wrap(~ country, ncol = 2, labeller = as_labeller(c(BE="Belgia", BG="Bulgaria", NL="Nederland", NO="Norge"))) +
labs(title = "Gini per NUTS2 over tid (fasettert etter land)",
x = "År", y = "Gini-koeffisient") +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
# {r, fig.cap="Gini per NUTS2 over tid, fasettert per land",
# fig.alt="Tynne linjer for hver NUTS2 med fasetter per land"}
figuren_gini <- gini %>%
filter(!is.na(Gini_weighted)) %>%        # Fjerner rader med manglende Gini (NA)
ggplot(aes(TIME_PERIOD, Gini_weighted, group = NUTS2)) +  # Setter opp tidsserie per NUTS2-region
geom_line(alpha = 0.25) +                # Tegner tynne linjer for hver NUTS2-region (gjennomsiktighet 25%)
facet_wrap(~ country, ncol = 2,          # Lager separate paneler (fasetter) for hvert land
labeller = as_labeller(c(
BE = "Belgia",
BG = "Bulgaria",
NL = "Nederland",
NO = "Norge"))) +
labs(title = "Gini per NUTS2 over tid (fasettert etter land)",  # Tittel og aksetitler
x = "År",
y = "Gini-koeffisient") +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))    # Midtstiller og gjør tittelen fet
figuren_gini
# Median Gini per land per år
gini_median <- gini %>%
filter(!is.na(Gini_weighted)) %>%
group_by(country, TIME_PERIOD) %>%
summarise(median_gini = median(Gini_weighted), .groups = "drop") %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge"))
gini_median
# Høyeste og laveste median Gini per land (med år)
gini_median_max_min <- gini_median %>%
group_by(country) %>%
summarise(
max_median_gini = max(median_gini, na.rm = TRUE),
year_max = TIME_PERIOD[which.max(median_gini)],
min_median_gini = min(median_gini, na.rm = TRUE),
year_min = TIME_PERIOD[which.min(median_gini)])
gini_median_max_min
# {r, fig.cap="Utvikling i median Gini (NUTS2) etter land, 2000–2023", fig.alt="Linjeplott for median Gini per land"}
figuren_gini_median <- gini_median %>%
ggplot(aes(TIME_PERIOD, median_gini, color = land_full)) +
geom_line(linewidth = 1.2, linetype = "solid") +
labs(title = "Utvikling i median Gini (NUTS2)",
x = "År", y = "Median Gini", color = "Land") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
figuren_gini_median
# {r, fig.cap="Fordeling av Gini-koeffisienter (NUTS2) etter land, 2000–2023", fig.alt="Boksplott for Gini-fordeling per land"}
figuren_gini <- gini %>%
filter(!is.na(Gini_weighted)) %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge")) %>%
ggplot(aes(land_full, Gini_weighted, fill = land_full)) +
geom_boxplot(outlier.alpha = 0.5) +
labs(title = "Fordeling av Gini (NUTS2) etter land",
x = "Land", y = "Gini-koeffisient") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")
figuren_gini
# Beregner BNP per innbygger etter å merge dataene
gdp_pop <- gdp_pop %>%
mutate(GDPC = (values_gdp * 1e6) / values_pop) %>% # BNP per innbygger (GDPC) er beregnet i euro per person
filter(values_pop > 0, is.finite(GDPC)) # Fjerner ugyldige eller ekstreme observasjoner
# Sjekker datastrukturen og verdiene etter sammenslåing og beregning
# Viser strukturen til datasettet etter beregningen
glimpse(gdp_pop)
# Oppsummerer sentrale statistiske mål for å kontrollere verdiene
summary(gdp_pop)
# Grunnleggende deskriptiv statistikk for merged datasettet
gdp_pop_summary <- gdp_pop %>%
filter(values_pop > 0, is.finite(GDPC)) %>%
summarise(
n_obs = n(),
Min = min(GDPC, na.rm = TRUE),
Q1  = quantile(GDPC, 0.25, na.rm = TRUE),
Median = median(GDPC, na.rm = TRUE),
Mean = mean(GDPC, na.rm = TRUE),
Q3  = quantile(GDPC, 0.75, na.rm = TRUE),
Max = max(GDPC, na.rm = TRUE),
SD  = sd(GDPC, na.rm = TRUE)
)
gdp_pop_summary
# viser den generelle fordelingen av BNP per innbygger
bnp_per_innbygger <- gdp_pop %>%
ggplot(aes(x = GDPC)) +
geom_histogram(bins = 40, fill = "steelblue", color = "white") +
labs(
title = "Fordeling av BNP per innbygger (alle regioner)",
x = "BNP per innbygger (euro per person)",
y = "Antall regioner"
)
bnp_per_innbygger
# Deskriptiv statistikk for hvert land
gdp_pop_land_summary <- gdp_pop %>%
filter(values_pop > 0, is.finite(GDPC)) %>%
mutate(country = substr(geo, 1, 2)) %>%
group_by(country) %>%
summarise(
n_obs = n(),
Min = min(GDPC, na.rm = TRUE),
Q1  = quantile(GDPC, 0.25, na.rm = TRUE),
Median = median(GDPC, na.rm = TRUE),
Mean = mean(GDPC, na.rm = TRUE),
Q3  = quantile(GDPC, 0.75, na.rm = TRUE),
Max = max(GDPC, na.rm = TRUE),
SD  = sd(GDPC, na.rm = TRUE)
)
gdp_pop_land_summary
# Sammenligning mellom land: boksdiagram
bnp_per_innbygger_land  <- gdp_pop %>%
mutate(
land_full = recode(substr(geo, 1, 2),
"BE" = "Belgia",
"BG" = "Bulgaria",
"NL" = "Nederland",
"NO" = "Norge")) %>%
ggplot(aes(x = land_full, y = GDPC, fill = land_full)) +
geom_boxplot() +
labs(
title = "BNP per innbygger etter land",
x = "Land",
y = "BNP per innbygger (euro)"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")
bnp_per_innbygger_land
# Utvikling av BNP per innbygger over tid (medianverdi)
bnp_over_tid_median <- gdp_pop %>%
mutate(land = substr(geo, 1, 2)) %>%
group_by(land, TIME_PERIOD) %>%
summarise(
median_BNPI = median(GDPC, na.rm = TRUE),
.groups = "drop"
) %>%
mutate(land_full = recode(land,
"BE" = "Belgia",
"BG" = "Bulgaria",
"NL" = "Nederland",
"NO" = "Norge")) %>%
ggplot(aes(x = TIME_PERIOD, y = median_BNPI, color = land_full)) +
geom_line(linewidth = 1.2) +
scale_y_continuous(limits = c(0, 70000),
labels = scales::comma) +
labs(
title = "Utvikling i median BNP per innbygger (2000–2023)",
x = "År",
y = "BNP per innbygger (euro)",
color = "Land"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
legend.title = element_text(face = "bold"),
legend.position = "right"
)
bnp_over_tid_median
# Beregner befolkningsvektet Gini på NUTS2-nivå (basert på GDPC for NUTS3)
gini <- gdp_pop %>%
mutate(
NUTS2   = substr(geo, 1, 4),# Henter NUTS2-kode fra NUTS3 og legger til landkode
country = substr(geo, 1, 2)
) %>%
filter(values_pop > 0, is.finite(GDPC)) %>% # Fjerner ugyldige observasjoner (befolkning ≤ 0 eller manglende
group_by(country, NUTS2, TIME_PERIOD) %>%
summarise(
n_nuts3 = dplyr::n(),# Teller hvor mange NUTS3-regioner som inngår i hver NUTS2-gruppe
Gini_weighted = if (dplyr::n() >= 2) {
# Beregner befolkningsvektet Gini ved hjelp av funksjonen gini.wtd()
as.numeric(dineq::gini.wtd(GDPC, weights = values_pop))
} else {
NA_real_
}, # Hvis NUTS2 bare består av én NUTS3 → ingen intern ulikhet → Gini settes til NA
.groups = "drop"
)
# Sjekker struktur og summary
# Sjekker strukturen til Gini-resultatene
glimpse(gini)
# Oppsummerer Gini-fordelingen
summary(gini$Gini_weighted)
# statistikk totalt gini
gini_totalt <- gini %>%
summarise(
n_obs = sum(!is.na(Gini_weighted)),
Min   = min(Gini_weighted, na.rm = TRUE),
Q1    = quantile(Gini_weighted, 0.25, na.rm = TRUE),
Median= median(Gini_weighted, na.rm = TRUE),
Mean  = mean(Gini_weighted, na.rm = TRUE),
Q3    = quantile(Gini_weighted, 0.75, na.rm = TRUE),
Max   = max(Gini_weighted, na.rm = TRUE),
SD    = sd(Gini_weighted, na.rm = TRUE)
)
gini_totalt
# statistikk gini etter land
gini_etter_land <- gini %>%
group_by(country) %>%
summarise(
n_obs = sum(!is.na(Gini_weighted)),
Min   = min(Gini_weighted, na.rm = TRUE),
Q1    = quantile(Gini_weighted, 0.25, na.rm = TRUE),
Median= median(Gini_weighted, na.rm = TRUE),
Mean  = mean(Gini_weighted, na.rm = TRUE),
Q3    = quantile(Gini_weighted, 0.75, na.rm = TRUE),
Max   = max(Gini_weighted, na.rm = TRUE),
SD    = sd(Gini_weighted, na.rm = TRUE),
.groups = "drop"
)
gini_etter_land
# Beregner befolkningsvektet Gini på NUTS2-nivå (basert på GDPC for NUTS3)
gini <- gdp_pop %>%
mutate(
NUTS2   = substr(geo, 1, 4),# Henter NUTS2-kode fra NUTS3 og legger til landkode
country = substr(geo, 1, 2)
) %>%
filter(values_pop > 0, is.finite(GDPC)) %>% # Fjerner ugyldige observasjoner (befolkning ≤ 0 eller manglende
group_by(country, NUTS2, TIME_PERIOD) %>%
summarise(
n_nuts3 = dplyr::n(),# Teller hvor mange NUTS3-regioner som inngår i hver NUTS2-gruppe
Gini_weighted = if (dplyr::n() >= 2) {
# Beregner befolkningsvektet Gini ved hjelp av funksjonen gini.wtd()
as.numeric(dineq::gini.wtd(GDPC, weights = values_pop))
} else {
NA_real_
}, # Hvis NUTS2 bare består av én NUTS3 → ingen intern ulikhet → Gini settes til NA
.groups = "drop"
)
# Sjekker struktur og summary
# Sjekker strukturen til Gini-resultatene
glimpse(gini)
# Oppsummerer Gini-fordelingen
summary(gini$Gini_weighted)
# statistikk totalt gini
gini_totalt <- gini %>%
summarise(
n_obs = sum(!is.na(Gini_weighted)),
Min   = min(Gini_weighted, na.rm = TRUE),
Q1    = quantile(Gini_weighted, 0.25, na.rm = TRUE),
Median= median(Gini_weighted, na.rm = TRUE),
Mean  = mean(Gini_weighted, na.rm = TRUE),
Q3    = quantile(Gini_weighted, 0.75, na.rm = TRUE),
Max   = max(Gini_weighted, na.rm = TRUE),
SD    = sd(Gini_weighted, na.rm = TRUE)
)
gini_totalt
# statistikk gini etter land
gini_etter_land <- gini %>%
group_by(country) %>%
summarise(
n_obs = sum(!is.na(Gini_weighted)),
Min   = min(Gini_weighted, na.rm = TRUE),
Q1    = quantile(Gini_weighted, 0.25, na.rm = TRUE),
Median= median(Gini_weighted, na.rm = TRUE),
Mean  = mean(Gini_weighted, na.rm = TRUE),
Q3    = quantile(Gini_weighted, 0.75, na.rm = TRUE),
Max   = max(Gini_weighted, na.rm = TRUE),
SD    = sd(Gini_weighted, na.rm = TRUE),
.groups = "drop"
)
gini_etter_land
# Gjennomsnittlig Gini per land per år
gini_gjennomsnittlig <- gini %>%
filter(!is.na(Gini_weighted)) %>%
group_by(country, TIME_PERIOD) %>%
summarise(mean_gini = mean(Gini_weighted), .groups = "drop") %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge"))
gini_gjennomsnittlig
# Høyeste og laveste gjennomsnittlig Gini per land
gini_max_min <- gini_gjennomsnittlig %>%
group_by(country) %>%
summarise(
max_gini = max(mean_gini, na.rm = TRUE),
year_max = TIME_PERIOD[which.max(mean_gini)],
min_gini = min(mean_gini, na.rm = TRUE),
year_min = TIME_PERIOD[which.min(mean_gini)])
gini_max_min
# {r, fig.cap="Utvikling i gjennomsnittlig Gini (NUTS2) etter land, 2000–2023", fig.alt="Linjeplott som viser utviklingen i gjennomsnittlig Gini per land over tid"}
# figuren for gjennomsnittlig Gini per land per år
figuren_gini_gjennomsnittlig <- gini_gjennomsnittlig %>%
ggplot(aes(TIME_PERIOD, mean_gini, color = land_full)) +
geom_line(linewidth = 1.2) +
labs(title = "Utvikling i gjennomsnittlig Gini (NUTS2)",
x = "År", y = "Gjennomsnittlig Gini", color = "Land") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
figuren_gini_gjennomsnittlig
# Median Gini per land per år
gini_median <- gini %>%
filter(!is.na(Gini_weighted)) %>%
group_by(country, TIME_PERIOD) %>%
summarise(median_gini = median(Gini_weighted), .groups = "drop") %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge"))
gini_median
# Høyeste og laveste median Gini per land (med år)
gini_median_max_min <- gini_median %>%
group_by(country) %>%
summarise(
max_median_gini = max(median_gini, na.rm = TRUE),
year_max = TIME_PERIOD[which.max(median_gini)],
min_median_gini = min(median_gini, na.rm = TRUE),
year_min = TIME_PERIOD[which.min(median_gini)])
gini_median_max_min
# {r, fig.cap="Utvikling i median Gini (NUTS2) etter land, 2000–2023", fig.alt="Linjeplott for median Gini per land"}
figuren_gini_median <- gini_median %>%
ggplot(aes(TIME_PERIOD, median_gini, color = land_full)) +
geom_line(linewidth = 1.2, linetype = "solid") +
labs(title = "Utvikling i median Gini (NUTS2)",
x = "År", y = "Median Gini", color = "Land") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
figuren_gini_median
# Median Gini per land per år
gini_median <- gini %>%
filter(!is.na(Gini_weighted)) %>%
group_by(country, TIME_PERIOD) %>%
summarise(median_gini = median(Gini_weighted), .groups = "drop") %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge"))
gini_median
# Høyeste og laveste median Gini per land (med år)
gini_median_max_min <- gini_median %>%
group_by(country) %>%
summarise(
max_median_gini = max(median_gini, na.rm = TRUE),
year_max = TIME_PERIOD[which.max(median_gini)],
min_median_gini = min(median_gini, na.rm = TRUE),
year_min = TIME_PERIOD[which.min(median_gini)])
gini_median_max_min
# {r, fig.cap="Utvikling i median Gini (NUTS2) etter land, 2000–2023", fig.alt="Linjeplott for median Gini per land"}
figuren_gini_median <- gini_median %>%
ggplot(aes(TIME_PERIOD, median_gini, color = land_full)) +
geom_line(linewidth = 1.2, linetype = "solid") +
labs(title = "Utvikling i median Gini (NUTS2)",
x = "År", y = "Median Gini", color = "Land") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
figuren_gini_median
# {r, fig.cap="Fordeling av Gini-koeffisienter (NUTS2) etter land, 2000–2023", fig.alt="Boksplott for Gini-fordeling per land"}
figuren_gini <- gini %>%
filter(!is.na(Gini_weighted)) %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge")) %>%
ggplot(aes(land_full, Gini_weighted, fill = land_full)) +
geom_boxplot(outlier.alpha = 0.5) +
labs(title = "Fordeling av Gini (NUTS2) etter land",
x = "Land", y = "Gini-koeffisient") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")
figuren_gini
#| label: fig-gini_boxplot
#| fig-cap: "Fordeling av Gini-koeffisienter (NUTS2) etter land, 2000–2023. Figuren viser fordelingen av befolkningsvektet Gini mellom regioner i Belgia, Bulgaria, Nederland og Norge. Hver boks representerer variasjonen i regional ulikhet på NUTS2-nivå, der høyere verdier indikerer større forskjeller mellom regionene."
figuren_gini <- gini %>%
filter(!is.na(Gini_weighted)) %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge")) %>%
ggplot(aes(land_full, Gini_weighted, fill = land_full)) +
geom_boxplot(outlier.alpha = 0.5) +
labs(title = "Fordeling av Gini (NUTS2) etter land",
x = "Land", y = "Gini-koeffisient") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")
figuren_gini
#| label: fig-gini_boxplot
#| fig-cap: "Fordeling av Gini-koeffisienter (NUTS2) etter land, 2000–2023. Figuren viser fordelingen av befolkningsvektet Gini mellom regioner i Belgia, Bulgaria, Nederland og Norge. Hver boks representerer variasjonen i regional ulikhet på NUTS2-nivå, der høyere verdier indikerer større forskjeller mellom regionene."
figuren_gini_etter_land <- gini %>%
filter(!is.na(Gini_weighted)) %>%
mutate(land_full = recode(country,
"BE" = "Belgia", "BG" = "Bulgaria",
"NL" = "Nederland", "NO" = "Norge")) %>%
ggplot(aes(land_full, Gini_weighted, fill = land_full)) +
geom_boxplot(outlier.alpha = 0.5) +
labs(title = "Fordeling av Gini (NUTS2) etter land",
x = "Land", y = "Gini-koeffisient") +
theme_minimal(base_size = 13) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.position = "none")
figuren_gini_etter_land
#| label: fig-gini_over_tid
#| fig-cap: "Utvikling i Gini per NUTS2 over tid (2000–2023), fasettert etter land. Figuren viser utviklingen i den befolkningsvektede Gini-koeffisienten for hver NUTS2-region i Belgia, Bulgaria, Nederland og Norge. Hver linje representerer en enkelt NUTS2-region, og fasettene viser hvordan den regionale ulikheten utvikler seg innenfor hvert land over tid."
figuren_gini_over_tid <- gini %>%
filter(!is.na(Gini_weighted)) %>%        # Fjerner rader med manglende Gini (NA)
ggplot(aes(TIME_PERIOD, Gini_weighted, group = NUTS2)) +  # Setter opp tidsserie per NUTS2-region
geom_line(alpha = 0.25) +                # Tegner tynne linjer for hver NUTS2-region (gjennomsiktighet 25%)
facet_wrap(~ country, ncol = 2,          # Lager separate paneler (fasetter) for hvert land
labeller = as_labeller(c(
BE = "Belgia",
BG = "Bulgaria",
NL = "Nederland",
NO = "Norge"))) +
labs(title = "Gini per NUTS2 over tid (fasettert etter land)",  # Tittel og aksetitler
x = "År",
y = "Gini-koeffisient") +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))    # Midtstiller og gjør tittelen fet
figuren_gini_over_tid
