---
title: "Assignment 3, MSB104-gruppe 6 2025"
author: Karin Liang
editor: visual
format:
  pdf:
    pdf-engine: xelatex
    geometry:
      - top=1.2cm
      - bottom=2.0cm
      - left=3cm
      - right=3cm
    fontsize: 10.5pt
    linestretch: 1.1
  html:
    fig-cap-location: bottom
    fig-number: true
  typst: 
    papersize: a4
lang: NO_nb
bibliography: references.bib
execute:
  warning: false
  message: false
  error: false
---

# Introduksjon

Denne oppgaven har som mål å utforske alternative funksjonelle former og bruke panelestimater for å analysere forholdet mellom regional utvikling og inntektsulikhet i Belgia, Bulgaria, Nederland og Norge.

```{r}
#| label: setup
# Pakker
library(dplyr)
library(dineq)
library(tidyr)
library(ggplot2)
library(broom)
library(eurostat)
library(readxl) 
library(lmtest)     # For bptest og coeftest
library(car)        # For ncvTest (score-test)
library(tibble)     # For å lage tabeller
library(fixest)
library(plm)
library(modelsummary)
library(flextable)
```

# Del A: Testing av utviklingseffekter på tvers av delmengder

## Delmengdeanalyse

Resultatene fra del B i oppgave 2 viser at utdanning er den mest signifikante faktoren i den multiple lineære regresjonsmodellen.
Derfor velger jeg å bruke utdanning som grunnlag for å teste delutvalg (subset) i denne analysen.

### Datainnsamling

```{r}
# Laster ned utdanningsdatasettet fra Eurostat
utdanning <- get_eurostat("edat_lfse_04", time_format = "num") 
# Filtrerer utdanningsdata for 2017 og grupperer regionene etter lav, middels og høy utdanning
utdanning_2017 <- utdanning %>%
  filter(
    TIME_PERIOD == 2017,
    sex == "T",            # Begge kjønn
    age == "Y25-64",       # Aldersgruppen 25–64 år
    unit == "PC",          # Enhet: prosent av befolkningen
    nchar(geo) == 4,       # Beholder kun NUTS2-nivå (fire tegn)
    substr(geo, 1, 2) %in% c("BE","NL","BG","NO"),
    isced11 != "ED3-8"
  )%>%
  mutate(edu_group = case_when(
    isced11 == "ED0-2" ~ "Low",
    isced11 %in% c("ED3_4", "ED3_4GEN", "ED3_4VOC") ~ "Medium",
    isced11 == "ED5-8" ~ "High",
    TRUE ~ NA_character_
  )) # lager tre utdanningsnivå (lav, middels, høy)
# Gjør utdanningsdata om til bredt format med tre kolonner for lav, middels og høy utdanning per region
utdanning_2017_trenivå <- utdanning_2017 %>%
  select(geo, edu_group, values) %>%
  pivot_wider(names_from = edu_group, values_from = values) %>%
  rename(
    `Lav_utdanning`     = Low,
    `Middels_utdanning` = Medium,
    `Høy_utdanning`     = High
  )
```

```{r}
# leser excel data_2017_b som brukt i assignment 2 del b
data_2017_b <- read_excel("./data_2017_b.xlsx", sheet = "data_2017_b")
# Slå sammen med hoveddatasettet (NUTS2 <-> geo)
data_2017 <- data_2017_b %>%
  left_join(utdanning_2017_trenivå, by = c("NUTS2" = "geo")) %>%
  select(-utdanning_hoy)
```

### Estimering av effekten av tre utdanningsnivåer på ulikhet

```{r}
# Low education subset
model_lav  <- lm(Gini_weighted ~ change_GDPC_pct + vei_tetthet + andelen_over65 + Lav_utdanning, data = data_2017)
summary(model_lav)
```

```{r}
# Medium education subset
model_middels  <- lm(Gini_weighted ~ change_GDPC_pct + vei_tetthet + andelen_over65 + Middels_utdanning, data = data_2017)
summary(model_middels)
```

```{r}
# High education subset
model_hoy  <- lm(Gini_weighted ~ change_GDPC_pct + vei_tetthet + andelen_over65 + Høy_utdanning, data = data_2017)
summary(model_hoy)
```

```{r}
#| label: tbl-subset
#| tbl-cap: "Resultater av delmengderegresjon på tvers av utdanningsgrupper"
modelsummary(
  list(
    "Low education regions"    = model_lav,
    "Medium education regions" = model_middels,
    "High education regions"   = model_hoy
  ),
  stars = TRUE,
  statistic = "({statistic})",
  fmt = 5,
  output = "markdown"   
  )
```

## Diskusjon om delmengdeanalyse: (200–400 ord)

Som vist i tabell @tbl-subset undersøker delmengdeanalysen om sammenhengen mellom regional økonomisk utvikling og inntektsulikhet varierer på tvers av regioner med ulike utdanningsprofiler.
Når de andre tre variablene holdes konstante, viser resultatene at ulike utdanningsnivåer som lavt, middels og høyt påvirker inntektsulikheten på forskjellige måter.
I regioner med lav utdanning er utviklingseffekten (change_GDPC_pct) positiv, men ikke signifikant (omtrent estimate 0.003 og p 0.567), noe som tyder på at økonomisk vekst alene ikke reduserer ulikheten.
Lav utdanning har en negativ og signifikant effekt (omtrent estimate −0.0046 og p 0.046), som betyr at økt utdanningsnivå i lavt utdannede regioner bidrar til å redusere forskjeller.
Her spiller utdanning en sterkere rolle enn både økonomisk utvikling og infrastruktur.
I regioner med middels utdanning er utviklingseffekten svak positiv (omtrent p 0.098), mens middels utdanning har en negativ, men ikke signifikant effekt (p 0.124).
Veitetthet viser derimot en tydelig negativ og signifikant effekt (p = 0.043).
Dette indikerer at infrastruktur har større forklaringskraft enn utdanning i disse områdene, og at bedre tilkobling mellom regioner kan bidra mer effektivt til å redusere inntektsulikhet enn økt utdanningsnivå.
I regioner med høy utdanning er både økonomisk utvikling (p = 0.057) og høy utdanning (p = 0.0097) positivt og signifikant knyttet til ulikhet.
Veitetthet har derimot en negativ og signifikant effekt (estimate −0.0009, p 0.039), noe som tyder på at bedre infrastruktur kan bidra til å dempe forskjeller som ellers øker med økonomisk vekst og høyt utdanningsnivå.
Dette antyder at når utdanningsnivået allerede er høyt, fører videre vekst og utdanning til at inntektsforskjellene øker, sannsynligvis fordi gevinsten av utviklingen tilfaller de mest kvalifiserte gruppene.
Samlet viser analysen at utdanning reduserer ulikhet i lavt utdannede regioner, men kan forsterke forskjeller i høyt utdannede regioner, mens infrastruktur fremstår som en mer stabil og gjennomgående utjevnende faktor.

# Del B: Utforsking av alternative funksjonsformer

## Utforsk alternative funksjonsformer

```{r}
# Log-lineær modell
model_log <- lm(Gini_weighted ~ log(change_GDPC_pct + 1) + vei_tetthet + andelen_over65 + `Høy_utdanning`, data = data_2017)
summary(model_log)
```

```{r}
# Kvadratisk modell
model_kvad <- lm(Gini_weighted ~ change_GDPC_pct + I(change_GDPC_pct^2) + vei_tetthet + andelen_over65 + `Høy_utdanning`, data = data_2017)
summary(model_kvad)
```

```{r}
# Kubisk modell
model_kub <- lm(Gini_weighted ~ change_GDPC_pct + I(change_GDPC_pct^2) + I(change_GDPC_pct^3) + vei_tetthet + andelen_over65 + `Høy_utdanning`, data = data_2017)
summary(model_kub)
```

```{r}
#| label: tbl-funksjonsformer
#| tbl-cap: "logaritmiske, kvadratiske, kubiske"
modelsummary(
  list(
    "Log-lineær modell" = model_log,
    "Kvadratisk modell" = model_kvad,
    "Kubisk modell"     = model_kub
  ),
  stars = TRUE,
  statistic = "({statistic})",   # viser t-verdier i parentes
  fmt = 5,
  output = "markdown"   
)
```

### Begrunn valgene mine

Blant de tre funksjonelle formene gir både den log-lineære og den kvadratiske modellen en bedre tilpasning enn den lineære modellen.
Den log-lineære modellen har lavest AIC (−76.77), mens den kvadratiske har høyest justert R² (0.528), slik resultatene i tabell @tbl-funksjonsformer viser.
Jo høyere R², desto bedre; jo lavere AIC, desto bedre.
Begge modellene gir dermed en bedre empirisk forklaring på sammenhengen mellom økonomisk utvikling og ulikhet, noe som også støttes @kuznets2019economic, der ulikheten først øker og deretter reduseres med økonomisk utvikling.
Resultatene støttes av artikkelen @LESSMANN2017110, om fant at ulikhet først øker og deretter avtar med økonomisk utvikling, og viser en N-formet sammenheng, noe som tilsvarer @kuznets2019economic.

## Visualisering

```{r}
# Lager et nytt datasett for visualisering av modellene
visualisering_data <- data.frame(
  change_GDPC_pct = seq(min(data_2017$change_GDPC_pct, na.rm = TRUE),
                        max(data_2017$change_GDPC_pct, na.rm = TRUE),
                        length.out = 100), # Oppretter 100 jevnt fordelte verdier for økonomisk vekst (change_GDPC_pct)
  vei_tetthet = mean(data_2017$vei_tetthet, na.rm = TRUE),
  andelen_over65 = mean(data_2017$andelen_over65, na.rm = TRUE),
  Høy_utdanning = mean(data_2017$`Høy_utdanning`, na.rm = TRUE)) # Holder de andre forklaringsvariablene konstante ved å bruke gjennomsnittsverdier

# Beregner predikerte Gini-verdier fra den log-lineære modellen
visualisering_data$pred_log  <- predict(model_log,  newdata = visualisering_data)
# Beregner predikerte Gini-verdier fra den kvadratiske modellen
visualisering_data$pred_kvad <- predict(model_kvad, newdata = visualisering_data)
```

```{r}
#| label: fig-log-kvadratisk
#| fig-cap: "Visualisering av log-lineær og kvadratisk modell for sammenhengen mellom økonomisk utvikling og inntektsulikhet"
visualisering <- data_2017 %>% 
  ggplot(aes(x = change_GDPC_pct, y = Gini_weighted)) +
  geom_point(alpha = 0.6, color = "grey40") +
  geom_line(
    data = visualisering_data, 
    mapping = aes(y = pred_log, color = "Log-lineær modell"), 
    linewidth = 1.2
    ) +
  geom_line(
    data = visualisering_data, 
    mapping = aes(y = pred_kvad, color = "Kvadratisk modell"), 
    linewidth = 1.2, 
    linetype = "dashed"
    ) +
  scale_color_manual(values = c("Log-lineær modell" = "blue", "Kvadratisk modell" = "red")) +
  labs(
    title = "Sammenheng mellom økonomisk utvikling og inntektsulikhet",
    subtitle = "Sammenligning av log-lineær og kvadratisk modell",
    x = "Endring i BNP per innbygger (%)",
    y = "Gini-koeffisient",
    color = "Modell"
  ) +
  theme_minimal(base_size = 13)  +
  theme(
    legend.text = element_text(size = 5),   
    legend.title = element_text(size = 6)  
  )
visualisering
```

@fig-log-kvadratisk viser sammenhengen mellom økonomisk utvikling og inntektsulikhet, der x-aksen viser endringen i BNP per innbygger (%) og y-aksen viser Gini-koeffisienten.
Den log-lineære modellen (blå linje) viser en jevn og gradvis økning i ulikhet når BNP-veksten stiger.
Den kvadratiske modellen (rød stiplet linje) har en tydelig buet form der ulikheten først øker og deretter flater ut eller synker svakt ved høyere vekstnivåer.

## Tolkning av resultater (opp til 400 ord)

Resultatene fra @tbl-funksjonsformer viser at den log-lineære og den kvadratiske modellen er mer overbevisende enn den kubiske modellen.
Den log-lineære modellen har den laveste AIC-verdien (–76.77), mens den kvadratiske modellen har den høyeste justerte R² (0.528).
I den log-lineære modellen er koeffisienten til log(change_GDPC_pct + 1) positiv og signifikant (Estimate = 0.0827, p = 0.030).
Dette innebærer at inntektsulikheten øker når BNP-veksten stiger, men at effekten avtar ved høyere vekstnivåer.
Den kvadratiske modellen viser også en ikke-lineær sammenheng.
Førsteordensleddet er positivt og signifikant (Estimate = 0.03697, p = 0.049), mens andreordensleddet er negativt (Estimate = –0.0019996, p = 0.140).
Selv om det sistnevnte ikke er signifikant, antyder retningen at økningen i ulikhet avtar ved høyere vekstnivåer.
Dette kan tolkes som @kuznets2019economic, der ulikheten først øker og senere flater ut.
Den kubiske modellen gir derimot ingen forbedring.
R² og AIC er svakere enn i de to andre modellene, og modellen tilfører dermed ikke ytterligere innsikt.
Samlet sett peker resultatene mot en ikke-lineære utvikling der økonomisk vekst øker inntektsulikheten, men hvor effekten gradvis svekkes.
Den log-lineære og den kvadratiske modellen fanger dette mønsteret best.

# Del C: Heteroskedastisitetstesting og kausalitetsdiskusjon

## Heteroskedastisitetstesting

```{r}
# Breusch–Pagan-test
bp_log  <- bptest(model_log)
bp_kvad <- bptest(model_kvad)
bp_kub  <- bptest(model_kub)

# White-test (BP på predikerte verdier og deres kvadrat)
wt_log  <- bptest(model_log,  ~ fitted(model_log)  + I(fitted(model_log)^2))
wt_kvad <- bptest(model_kvad, ~ fitted(model_kvad) + I(fitted(model_kvad)^2))
wt_kub  <- bptest(model_kub,  ~ fitted(model_kub)  + I(fitted(model_kub)^2))

# Score-test (car::ncvTest)
sc_log  <- ncvTest(model_log)
sc_kvad <- ncvTest(model_kvad)
sc_kub  <- ncvTest(model_kub)
```

```{r}
#| label: tbl-heteroskedastisitet
#| tbl-cap: "Resultater fra Breusch–Pagan-, White- og Score-testene for de tre modellene"
# Samler testresultatene i en tabell
hetero_test <- tibble(
  Modell  = c("Log-lineær", "Kvadratisk", "Kubisk"),
  BP_p    = c(bp_log$p.value,  bp_kvad$p.value,  bp_kub$p.value),
  White_p = c(wt_log$p.value,  wt_kvad$p.value,  wt_kub$p.value),
  Score_p = c(sc_log$p,        sc_kvad$p,        sc_kub$p)
)
hetero_test |> 
  flextable()
```

### Tolk og diskuter resultatene og implikasjonene (opptil 200 ord).

Resultatene fra @tbl-heteroskedastisitet viser at Breusch–Pagan-, White- og Score-testene ikke finner noen tegn til heteroskedastisitet i noen av modellene.
For den log-lineære modellen er p-verdiene 0.456 (BP), 0.185 (White) og 0.205 (Score).
Den kvadratiske modellen har tilsvarende høye p-verdier (0.467, 0.189 og 0.282), og selv for den kubiske modellen ligger alle p-verdiene godt over 0.05 (0.450, 0.096 og 0.166).
Siden alle testene gir p-verdier over 0.05, kan ikke nullhypotesen om homoskedastisitet forkastes.
Dette betyr at variansen i residualene er stabil, og at modellen ikke lider av heteroskedastisitet.
Det er derfor ikke behov for å benytte robuste standardfeil, ettersom heteroskedastisitet ikke utgjør et problem i disse modellene.

## Kausalitetsdiskusjon (200–400 ord)

Selv om denne studien viser en statistisk sammenheng mellom økonomisk utvikling og inntektsulikhet, der utdanning, transport og demografi inngår som forklaringsvariabler, kan resultatene ikke tolkes som kausale.
Det finnes flere grunner til dette.
For det første kan det være omvendt kausalitet.
Økonomisk vekst kan påvirke ulikhet, men ulikhet kan også påvirke vekst.
For eksempel kan regioner med høy ulikhet ha lavere investeringer i utdanning, dårligere transportforhold og en skjev befolkningssammensetning, noe som kan redusere økonomisk utvikling.
I dette tilfellet viser modellen en toveis sammenheng snarere enn en klar årsakssammenheng.
For det andre kan modellen mangle viktige variabler.
Selv om analysen inkluderer utdanning, veitetthet og andelen eldre, noe som gir modellen en viss forklaringskraft, mangler det fortsatt flere andre sentrale faktorer som blant annet institusjonskvalitet, arbeidsmarkedsforhold eller fordeling av kapital.
Dersom slike faktorer påvirker både økonomisk vekst og ulikhet, kan resultatene bli skjeve på grunn av utelatte variabler.
Et annet problem er samtidig påvirkning.
Økonomisk vekst og inntektsulikhet kan påvirke hverandre i samme periode, og ikke bare i én retning.
Når begge variablene endrer seg samtidig og påvirker hverandre, blir det vanskelig å skille hva som er årsak og hva som er virkning.
For å identifisere kausale sammenhenger bedre, trengs mer presise analyser som kan kontrollere for regionale forhold som ikke endrer seg over tid, og dermed redusere problemet med utelatte variabler.
Det er også mulig å bruke instrumentvariabler eller tidsforsinkede variabler for å redusere omvendt kausalitet og samtidig påvirkning.
Flere kontrollvariabler eller lengre tidsserier kan i tillegg gjøre kausalanalysen mer pålitelig.
Oppsummert viser analysen bare at det finnes en sammenheng mellom variablene, men ikke hva som er årsaken.
For å si noe mer sikkert om årsakssammenhenger, trengs det mer grundige analyser som kan håndtere at viktige forhold kan mangle i modellen, eller at variablene kan påvirke hverandre.

# Del D: Panel

## Panelestimering

### Datainnsamling for Panelestimering

```{r}
# Laster ned og filtrerer datasett for perioden 2008–2022
# Nedlasting av BNP 2008–2022
gdp_panel <- get_eurostat("nama_10r_3gdp", time_format="num") %>%
  filter(
    unit == "MIO_EUR",
    TIME_PERIOD %in% 2008:2022,
    nchar(geo) == 5,
    substr(geo,1,2) %in% c("BE","NL","BG","NO")
  ) %>%
  select(geo, TIME_PERIOD, values_gdp = values)

# Nedlasting av befolkning 2008–2022
pop_panel <- get_eurostat("demo_r_pjanaggr3", time_format="num") %>%
  filter(
    sex == "T",
    age == "TOTAL",
    TIME_PERIOD %in% 2008:2022,
    nchar(geo) == 5,
    substr(geo,1,2) %in% c("BE","NL","BG","NO")
  ) %>%
  select(geo, TIME_PERIOD, values_pop = values)

# Slå sammen
gdp_pop_panel <- gdp_panel %>%
  left_join(pop_panel, by = c("geo", "TIME_PERIOD")) %>%
  mutate(
    NUTS2 = substr(geo, 1, 4),
    GDPC  = values_gdp * 1e6 / values_pop
  ) %>%
  filter(values_pop > 0, is.finite(GDPC)) %>%
  # beregnes årlig vekstrate i GDPC på NUTS2-nivå
  group_by(NUTS2) %>%
  arrange(TIME_PERIOD, .by_group = TRUE) %>%
  mutate(change_GDPC_pct = (GDPC / lag(GDPC) - 1) * 100) %>%
  ungroup() %>%
  # beregnes Gini på (NUTS2, TIME_PERIOD)-nivå, og oppsummeres direkte
  group_by(NUTS2, TIME_PERIOD) %>%
  mutate(
    Gini_weighted = if (n() >= 2)
      as.numeric(gini.wtd(GDPC, weights = values_pop))
    else
      NA_real_
  ) %>%
  summarise(
    GDPC           = sum(values_gdp * 1e6) / sum(values_pop),  # Befolkningsvektet GDPC for NUTS2
    change_GDPC_pct = mean(change_GDPC_pct, na.rm = TRUE),      # Skal være identisk innen samme NUTS2-år
    Gini_weighted   = mean(Gini_weighted, na.rm = TRUE),        # Beholder NA, filtrerer ikke bort
    .groups = "drop"
  )
```

```{r}
# høy utdanning 2008–2022
edu_panel <- utdanning %>%
  filter(
    TIME_PERIOD %in% 2008:2022,
    sex=="T", age=="Y25-64", unit=="PC",
    isced11=="ED5-8",
    nchar(geo)==4,
    substr(geo,1,2) %in% c("BE","NL","BG","NO")
  ) %>%
  select(NUTS2 = geo, TIME_PERIOD, Høy_utdanning = values)
```

```{r}
# population (andel over 65 år) 2008–2022
pop_panel <- get_eurostat("demo_r_pjangrp3", time_format="num") %>%
  filter(
    TIME_PERIOD %in% 2008:2022,
    sex=="T",
    nchar(geo)==4,
    substr(geo,1,2) %in% c("BE","NL","BG","NO")
  ) %>%
  group_by(geo, TIME_PERIOD) %>%
  summarise(
    pop_over65 = sum(values[age %in% c("Y65-69","Y70-74","Y75-79","Y80-84","Y85-89","Y_GE85")]),
    pop_total  = sum(values[age=="TOTAL"]),
    andelen_over65 = pop_over65/pop_total * 100,
    .groups = "drop"
  ) %>%
  rename(NUTS2=geo)%>%
  select(NUTS2, TIME_PERIOD, andelen_over65)
```

```{r}
# Kobler sammen datasett
panel_df <- gdp_pop_panel %>%
  left_join(edu_panel, by = c("NUTS2", "TIME_PERIOD")) %>%
  left_join(pop_panel, by = c("NUTS2", "TIME_PERIOD"))
```

### Panelmodeller (Fire FE-spesifikasjoner)

```{r}
# Oppretter landkode fra NUTS2 og aggregerer data til land × år
panel_country <- panel_df %>%
  mutate(country = substr(NUTS2, 1, 2)) %>%
  group_by(country, TIME_PERIOD) %>%
  summarise(
    Gini_weighted   = mean(Gini_weighted,   na.rm = TRUE),
    change_GDPC_pct = mean(change_GDPC_pct, na.rm = TRUE),
    Høy_utdanning   = mean(Høy_utdanning,   na.rm = TRUE),
    andelen_over65  = mean(andelen_over65,  na.rm = TRUE),
    .groups = "drop"
  )

panel_country <- pdata.frame(panel_country, index = c("country", "TIME_PERIOD"))

# Modell 1: land-faste effekter
fe_country <- plm(
  Gini_weighted ~ change_GDPC_pct + Høy_utdanning + andelen_over65,
  data   = panel_country,
  model  = "within",
  effect = "individual"
)
summary(fe_country)
```

```{r}
# Konverterer datasettet til et panelobjekt med NUTS2 som enhets-ID og TIME_PERIOD som tidsvariabel
panel_df <- pdata.frame(panel_df, index = c("NUTS2", "TIME_PERIOD"))
```

```{r}
# Modell 2: Faste effekter for år (year FE)
fe_year <- plm(
  Gini_weighted ~ change_GDPC_pct + Høy_utdanning + andelen_over65,
  data   = panel_df,   # pdata.frame med NUTS2 og år
  model  = "within",
  effect = "time"      # år som tids-FE
)
summary(fe_year)
```

```{r}
# Modell 3: Faste effekter på NUTS2-nivå (region FE)
fe_region <- plm(
  Gini_weighted ~ change_GDPC_pct + Høy_utdanning + andelen_over65,
  data   = panel_df,
  model  = "within",
  effect = "individual"    # individual = NUTS2-FE siden panelet er indeksert etter NUTS2
)
summary(fe_region)
```

```{r}
# Modell 4: Toveis faste effekter (NUTS2 + år)
fe_twoway <- plm(
  Gini_weighted ~ change_GDPC_pct + Høy_utdanning + andelen_over65,
  data   = panel_df,
  model  = "within",
  effect = "twoways"  # kontrollerer både for NUTS2- og årsfaste effekter
)
summary(fe_twoway)
```

```{r}
#| label: tbl-panel
#| tbl-cap: "Sammenligning av panelmodeller"
modelsummary(
  list(
    "Region FE"   = fe_region,
    "Year FE"    = fe_year,
    "Two-way FE" = fe_twoway,
    "Country FE" = fe_country
  ),
  stars = TRUE, 
  fmt = 5,
  output = "markdown"   
)
```

## Panelestimeringsanalyse: (opptil 400 ord)

I panelmodellen inkluderte jeg ikke transportinfrastruktur (veitetthet).
Selv om variabelen endrer seg over tid, er endringen så liten at den i praksis er tidsinvariant.
En faste-effekt-modell estimerer kun basert på tidsvariasjon innen samme region, og tidsinvariante variabler blir fullstendig absorbert av regionsfaste effekter.
Dermed kan ikke veitetthet estimeres på en korrekt måte og er utelatt fra panelanalysen.
I stedet inkluderes kun høyere utdanning og andelen av befolkningen over 65 år.
Som vist i @tbl-panel har alle fire modellene svært svak forklaringskraft, med R²-verdier på henholdsvis 0.004, 0.022, 0.006 og 0.009, og de justerte R²-verdiene er negative.
Dette indikerer at modellene i liten grad klarer å forklare utviklingen i regional inntektsulikhet over tid.\
Videre er koeffisientene for de inkluderte variablene svært små og gjennomgående ikke-signifikante.
For utdanningsnivået er p-verdiene i alle modellene klart over 0.1, blant annet p 0.41 (region FE), 0.86 (year FE), 0.51 (two-way FE) og 0.62 (country FE).
Andelen eldre har også p-verdier over 0.1 i de fleste modellene, som p 0.59 (region FE)), 0.45 (two-way FE) og 0.78 (country FE), med unntak av year FE-modellen der variabelen er svakt signifikant (p 0.0889).
Dette viser at disse variablene endrer seg svært lite over tid innen hver region, og derfor ikke klarer å forklare variasjonen i Gini-koeffisienten.
Samlet sett viser panelresultatene at de tidsmessige endringene innen regionene er begrenset.
Både Gini, utdanningsnivå og aldersstruktur er forholdsvis stabile, noe som gjør det utfordrende for modellen å identifisere tydelige tidseffekter.
Dette samsvarer med de lave R²-verdiene og manglende signifikans i @tbl-panel, og tyder på at regionale ulikheter i større grad skyldes langsiktige strukturelle forskjeller enn kortsiktige endringer.

## Panelestimeringsdiskusjon: (opptil 400 ord)

Basert på de samlede panelestimatene fremstår modellens forklaringskraft som svak.
Dette henger i stor grad sammen med den begrensede tidsvariasjonen i variablene samt egenskapene ved FE modeller, som benytter endringer over tid innen samme region til å identifisere effekter.
Transportinfrastruktur (veitetthet) er også en relevant forklaringsfaktor, men ble ikke inkludert i panelmodellen på grunn av modellens metodiske begrensninger.
Veitetthet er i praksis en tidsinvariant variabel i analyseperioden og vil derfor bli fullstendig absorbert av regionsfaste effekter.
Dermed kan den ikke estimeres i en faste-effekt-modell.
Dette innebærer at en potensielt viktig forklaringsvariabel faller bort, noe som ytterligere begrenser modellens totale forklaringskraft.
@tbl-panel viser tydelig at modellens forklaringskraft er svært svak.
I en modell med faste effekter er identifikasjonen basert på endringer over tid innenfor samme region.
I dette datasettet endrer imidlertid Gini, utdanningsnivå og andelen eldre over 65 år seg svært lite i perioden 2008–2022.
Fordi variablene nesten ikke varierer, har modellen svært begrenset tidsvariasjon å utnytte.
Derfor blir koeffisientene meget små, for eksempel er den laveste koeffisienten for utdanning –0.00036 og for andelen eldre –0.00055, mens den laveste R²-verdien er helt nede på 0.004.
Dette viser at modellen i liten grad klarer å forklare endringer over tid.
I toveis faste effekter (Two-way FE) blir mønsteret enda tydeligere.
Denne modellen kontrollerer både for regionspesifikke forskjeller og årsspesifikke sjokk, noe som gjør at enda mindre tidsvariasjon står igjen til å forklare endringer i ulikhet.
I toveis faste effekter (Two-way FE) er p-verdiene høye: 0.5141 for utdanningsnivå og 0.4457 for andelen eldre.
Begge ligger langt over 0.1, noe som viser at disse variablene ikke har noen tydelig statistisk effekt innen regionene over tid.
Samlet sett viser dette at regionale ulikheter i større grad skyldes stabile og langsiktige strukturelle forhold, og at kortsiktige endringer i utdanning, demografi og økonomisk utvikling spiller en svært begrenset rolle for utviklingen i Gini-koeffisienten i denne perioden.

# Del E: Dokumenter din bruk av KI

I denne oppgaven brukte jeg kunstig intelligens som støtte i skrive- og analysearbeidet.
Programvaren som ble benyttet var ChatGPT fra OpenAI (modell GPT-5.1).
KI-verktøyet ble hovedsakelig brukt til å korrigere kodefeil, oversette språk, oppsummere relevant litteratur, forklare datainnhold, forstå økonometriske begreper, kontrollere om teksten var klart formulert, samt bistå med språklig forbedring slik at fremstillingen ble presis og tydelig.
Gjennom prosessen hadde jeg en målrettet spørrestrategi, hvor jeg stilte flere presise spørsmål om konkrete temaer, for eksempel betydningen av faste effekter, toveis faste effekter, hvorfor tidsinvariante variabler ikke kan estimeres i FE-modeller, og hvordan panelresultater bør tolkes.
Jeg brukte også KI til å oversette enkelte avsnitt mellom kinesisk og norsk for å sikre at språket var konsistent i hele rapporten.
Etter hver redigering kontrollerte igjen jeg innholdet selv for å unngå overredigering og for å sikre at all analyse og alle konklusjoner var basert på min egen forståelse og mine egne data.
